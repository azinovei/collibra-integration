INFO 04/29/2020 06:31:29 AM Logging to logs/import.log
INFO 04/29/2020 06:31:29 AM Opening assets.yaml
INFO 04/29/2020 06:31:29 AM Opening resourceids.yaml
DEBUG 04/29/2020 06:31:29 AM Creating Okera context
INFO 04/29/2020 06:31:29 AM Using Okera token from environment
DEBUG 04/29/2020 06:31:29 AM Enabled token auth
INFO 04/29/2020 06:31:29 AM Using assets in 'assets.yaml' to run script...
INFO 04/29/2020 06:31:29 AM ############ START: PyOkera calls ############
DEBUG 04/29/2020 06:31:29 AM Connecting to planner sandbox.demo.okera.com:12050 with DIGEST-MD5 authentication mechanism
DEBUG 04/29/2020 06:31:29 AM get_socket: host=sandbox.demo.okera.com port=12050 use_ssl=False ca_cert=None
DEBUG 04/29/2020 06:31:29 AM get_transport: socket=<thriftpy.transport.socket.TSocket object at 0x10b0b1110> host=sandbox.demo.okera.com service_name=cerebro auth_mechanism=DIGEST-MD5 user=None password=fuggetaboutit host_override=None
DEBUG 04/29/2020 06:31:30 AM PlannerConnection(service=<okera.odas._ThriftService object at 0x10b0b1690>)
INFO 04/29/2020 06:31:30 AM 	Fetching table 'collibra_import.nifty'
DEBUG 04/29/2020 06:31:31 AM Closing Planner connection
DEBUG 04/29/2020 06:31:31 AM close_service: client=<thriftpy.thrift.TClient object at 0x10b0b1a90>
INFO 04/29/2020 06:31:31 AM ############ END: PyOkera calls ############
INFO 04/29/2020 06:31:31 AM ### START: Create table hash ###
INFO 04/29/2020 06:31:31 AM 	Successfully created hash for table 'collibra_import.nifty': e6282f361623fcec24316438d4678f20
INFO 04/29/2020 06:31:31 AM ### END: Create table hash ###
INFO 04/29/2020 06:31:31 AM ############ START: Collibra calls ############
INFO 04/29/2020 06:31:31 AM 	### START: Get resource IDs from resourceids.yaml ###
INFO 04/29/2020 06:31:31 AM 		Fetching resource ID for 'Table' in 'assets'
INFO 04/29/2020 06:31:31 AM 		Successfully fetched 00000000-0000-0000-0000-000000031007 for 'Table'
INFO 04/29/2020 06:31:31 AM 	### END: Get resource IDs from resourceids.yaml ###
INFO 04/29/2020 06:31:31 AM ### START: Making Collibra request ###
DEBUG 04/29/2020 06:31:31 AM Starting new HTTPS connection (1): okera.collibra.com:443
DEBUG 04/29/2020 06:31:32 AM https://okera.collibra.com:443 "GET /rest/2.0/assets/e59d95c6-bc64-4fb7-a8ab-0dea121ea697 HTTP/1.1" 200 354
INFO 04/29/2020 06:31:32 AM Request successful
INFO 04/29/2020 06:31:32 AM ### END: Making Collibra request ###
INFO 04/29/2020 06:31:32 AM 	Fetching Collibra Table 'collibra_import.nifty, asset ID: e59d95c6-bc64-4fb7-a8ab-0dea121ea697
INFO 04/29/2020 06:31:32 AM ############ END: Collibra calls ############
INFO 04/29/2020 06:31:32 AM ### START: Making Collibra request ###
DEBUG 04/29/2020 06:31:32 AM Starting new HTTPS connection (1): okera.collibra.com:443
DEBUG 04/29/2020 06:31:32 AM https://okera.collibra.com:443 "GET /rest/2.0/assets?name=collibra_import.nifty&nameMatchMode=EXACT&domainId=fdd4a0ad-4505-45c8-9d32-bd7c0769ddb0&communityId=36fd10bf-f6f3-44a6-807e-915c6a24c521&typeId=00000000-0000-0000-0000-000000031007 HTTP/1.1" 200 386
INFO 04/29/2020 06:31:32 AM Request successful
INFO 04/29/2020 06:31:32 AM ### END: Making Collibra request ###
INFO 04/29/2020 06:31:32 AM 	### START: Get resource IDs from resourceids.yaml ###
INFO 04/29/2020 06:31:32 AM 		Fetching resource ID for 'Table' in 'assets'
INFO 04/29/2020 06:31:32 AM 		Successfully fetched 00000000-0000-0000-0000-000000031007 for 'Table'
INFO 04/29/2020 06:31:32 AM 	### END: Get resource IDs from resourceids.yaml ###
INFO 04/29/2020 06:31:32 AM ############ START: Update asset 'collibra_import.nifty' ############
INFO 04/29/2020 06:31:32 AM ### START: Making Collibra request ###
DEBUG 04/29/2020 06:31:32 AM Starting new HTTPS connection (1): okera.collibra.com:443
DEBUG 04/29/2020 06:31:33 AM https://okera.collibra.com:443 "GET /rest/2.0/assets/e59d95c6-bc64-4fb7-a8ab-0dea121ea697/tags HTTP/1.1" 200 22
INFO 04/29/2020 06:31:33 AM Request successful
INFO 04/29/2020 06:31:33 AM ### END: Making Collibra request ###
INFO 04/29/2020 06:31:33 AM ###### Comparing Collibra tags of Table 'collibra_import.nifty' to Okera tags of Table 'collibra_import.nifty': ######
Collibra tags: []
Okera tags: None
DEBUG 04/29/2020 06:31:33 AM 	No differences found
INFO 04/29/2020 06:31:33 AM ### START: Making Collibra request ###
DEBUG 04/29/2020 06:31:33 AM Starting new HTTPS connection (1): okera.collibra.com:443
DEBUG 04/29/2020 06:31:34 AM https://okera.collibra.com:443 "GET /rest/2.0/attributes?assetId=e59d95c6-bc64-4fb7-a8ab-0dea121ea697 HTTP/1.1" 200 383
INFO 04/29/2020 06:31:34 AM Request successful
INFO 04/29/2020 06:31:34 AM ### END: Making Collibra request ###
INFO 04/29/2020 06:31:34 AM ###### Comparing Collibra attributes of Table 'collibra_import.nifty' to Okera attributes of Table 'collibra_import.nifty': ######
Collibra tags: {'Description': 'Kinda nifty.', 'Location': 'file:/test-warehouse/collibra_import.db/nifty'}
Okera tags: {'Description': 'Kinda nifty', 'Location': 'file:/test-warehouse/collibra_import.db/nifty'}
INFO 04/29/2020 06:31:34 AM 	Updating attributes for asset 'collibra_import.nifty'
DEBUG 04/29/2020 06:31:34 AM 	Attributes: [{'id': '2a6dc7b9-365a-49e5-9844-053c12a605ba', 'value': 'Kinda nifty'}]
INFO 04/29/2020 06:31:34 AM ### START: Making Collibra request ###
DEBUG 04/29/2020 06:31:34 AM Starting new HTTPS connection (1): okera.collibra.com:443
DEBUG 04/29/2020 06:31:35 AM https://okera.collibra.com:443 "POST /rest/2.0/attributes/bulk HTTP/1.1" 200 273
INFO 04/29/2020 06:31:35 AM Request successful
INFO 04/29/2020 06:31:35 AM ### END: Making Collibra request ###
INFO 04/29/2020 06:31:35 AM ### START: Set Okera table properties ###
INFO 04/29/2020 06:31:35 AM 	### START: Get resource IDs from resourceids.yaml ###
INFO 04/29/2020 06:31:35 AM 		Fetching resource ID for 'Table' in 'assets'
INFO 04/29/2020 06:31:35 AM 		Successfully fetched 00000000-0000-0000-0000-000000031007 for 'Table'
INFO 04/29/2020 06:31:35 AM 	### END: Get resource IDs from resourceids.yaml ###
DEBUG 04/29/2020 06:31:35 AM Connecting to planner sandbox.demo.okera.com:12050 with DIGEST-MD5 authentication mechanism
DEBUG 04/29/2020 06:31:35 AM get_socket: host=sandbox.demo.okera.com port=12050 use_ssl=False ca_cert=None
DEBUG 04/29/2020 06:31:35 AM get_transport: socket=<thriftpy.transport.socket.TSocket object at 0x10ab82ed0> host=sandbox.demo.okera.com service_name=cerebro auth_mechanism=DIGEST-MD5 user=None password=fuggetaboutit host_override=None
DEBUG 04/29/2020 06:31:36 AM PlannerConnection(service=<okera.odas._ThriftService object at 0x10b0be190>)
DEBUG 04/29/2020 06:31:36 AM 	Adding table properties for table 'collibra_import.nifty'
INFO 04/29/2020 06:31:36 AM 	Successfully added table property ('last_collibra_sync_time' = '1588192295') to table 'collibra_import.nifty'
DEBUG 04/29/2020 06:31:36 AM Closing Planner connection
DEBUG 04/29/2020 06:31:36 AM close_service: client=<thriftpy.thrift.TClient object at 0x10b0be1d0>
INFO 04/29/2020 06:31:36 AM ### END: Set Okera table properties ###
INFO 04/29/2020 06:31:36 AM ### START: Set Okera table properties ###
INFO 04/29/2020 06:31:36 AM 	### START: Get resource IDs from resourceids.yaml ###
INFO 04/29/2020 06:31:36 AM 		Fetching resource ID for 'Table' in 'assets'
INFO 04/29/2020 06:31:36 AM 		Successfully fetched 00000000-0000-0000-0000-000000031007 for 'Table'
INFO 04/29/2020 06:31:36 AM 	### END: Get resource IDs from resourceids.yaml ###
DEBUG 04/29/2020 06:31:36 AM Connecting to planner sandbox.demo.okera.com:12050 with DIGEST-MD5 authentication mechanism
DEBUG 04/29/2020 06:31:36 AM get_socket: host=sandbox.demo.okera.com port=12050 use_ssl=False ca_cert=None
DEBUG 04/29/2020 06:31:36 AM get_transport: socket=<thriftpy.transport.socket.TSocket object at 0x10aa57c90> host=sandbox.demo.okera.com service_name=cerebro auth_mechanism=DIGEST-MD5 user=None password=fuggetaboutit host_override=None
DEBUG 04/29/2020 06:31:37 AM PlannerConnection(service=<okera.odas._ThriftService object at 0x10b0ace90>)
DEBUG 04/29/2020 06:31:38 AM 	Adding table properties for table 'collibra_import.nifty'
INFO 04/29/2020 06:31:38 AM 	Successfully added table property ('table_hash' = 'e6282f361623fcec24316438d4678f20') to table 'collibra_import.nifty'
DEBUG 04/29/2020 06:31:38 AM Closing Planner connection
DEBUG 04/29/2020 06:31:38 AM close_service: client=<thriftpy.thrift.TClient object at 0x10ad252d0>
INFO 04/29/2020 06:31:38 AM ### END: Set Okera table properties ###
INFO 04/29/2020 06:31:38 AM ############ START: Collibra calls ############
INFO 04/29/2020 06:31:38 AM 	### START: Get resource IDs from resourceids.yaml ###
INFO 04/29/2020 06:31:38 AM 		Fetching resource ID for 'Column' in 'assets'
INFO 04/29/2020 06:31:38 AM 		Successfully fetched 00000000-0000-0000-0000-000000031008 for 'Column'
INFO 04/29/2020 06:31:38 AM 	### END: Get resource IDs from resourceids.yaml ###
INFO 04/29/2020 06:31:38 AM 	Fetching Collibra Column 'collibra_import.nifty.nifty_col'
INFO 04/29/2020 06:31:38 AM ############ END: Collibra calls ############
INFO 04/29/2020 06:31:38 AM ### START: Making Collibra request ###
DEBUG 04/29/2020 06:31:38 AM Starting new HTTPS connection (1): okera.collibra.com:443
DEBUG 04/29/2020 06:31:39 AM https://okera.collibra.com:443 "GET /rest/2.0/assets?name=collibra_import.nifty.nifty_col&nameMatchMode=EXACT&domainId=fdd4a0ad-4505-45c8-9d32-bd7c0769ddb0&communityId=36fd10bf-f6f3-44a6-807e-915c6a24c521&typeId=00000000-0000-0000-0000-000000031008 HTTP/1.1" 200 381
INFO 04/29/2020 06:31:39 AM Request successful
INFO 04/29/2020 06:31:39 AM ### END: Making Collibra request ###
INFO 04/29/2020 06:31:39 AM 	### START: Get resource IDs from resourceids.yaml ###
INFO 04/29/2020 06:31:39 AM 		Fetching resource ID for 'Column' in 'assets'
INFO 04/29/2020 06:31:39 AM 		Successfully fetched 00000000-0000-0000-0000-000000031008 for 'Column'
INFO 04/29/2020 06:31:39 AM 	### END: Get resource IDs from resourceids.yaml ###
INFO 04/29/2020 06:31:39 AM ############ START: Update asset 'collibra_import.nifty.nifty_col' ############
INFO 04/29/2020 06:31:39 AM ### START: Making Collibra request ###
DEBUG 04/29/2020 06:31:39 AM Starting new HTTPS connection (1): okera.collibra.com:443
DEBUG 04/29/2020 06:31:40 AM https://okera.collibra.com:443 "GET /rest/2.0/assets/9958b47b-2e3c-4b89-bd48-340f6bc027c3/tags HTTP/1.1" 200 22
INFO 04/29/2020 06:31:40 AM Request successful
INFO 04/29/2020 06:31:40 AM ### END: Making Collibra request ###
INFO 04/29/2020 06:31:40 AM ###### Comparing Collibra tags of Column 'collibra_import.nifty.nifty_col' to Okera tags of Column 'collibra_import.nifty.nifty_col': ######
Collibra tags: []
Okera tags: None
DEBUG 04/29/2020 06:31:40 AM 	No differences found
INFO 04/29/2020 06:31:40 AM ### START: Making Collibra request ###
DEBUG 04/29/2020 06:31:40 AM Starting new HTTPS connection (1): okera.collibra.com:443
DEBUG 04/29/2020 06:31:41 AM https://okera.collibra.com:443 "GET /rest/2.0/attributes?assetId=9958b47b-2e3c-4b89-bd48-340f6bc027c3 HTTP/1.1" 200 62
INFO 04/29/2020 06:31:41 AM Request successful
INFO 04/29/2020 06:31:41 AM ### END: Making Collibra request ###
INFO 04/29/2020 06:31:41 AM ###### Comparing Collibra attributes of Column 'collibra_import.nifty.nifty_col' to Okera attributes of Column 'collibra_import.nifty.nifty_col': ######
Collibra tags: {}
Okera tags: {'Description': None}
INFO 04/29/2020 06:31:41 AM ############ START: PyOkera calls ############
DEBUG 04/29/2020 06:31:41 AM Connecting to planner sandbox.demo.okera.com:12050 with DIGEST-MD5 authentication mechanism
DEBUG 04/29/2020 06:31:41 AM get_socket: host=sandbox.demo.okera.com port=12050 use_ssl=False ca_cert=None
DEBUG 04/29/2020 06:31:41 AM get_transport: socket=<thriftpy.transport.socket.TSocket object at 0x10ab82ed0> host=sandbox.demo.okera.com service_name=cerebro auth_mechanism=DIGEST-MD5 user=None password=fuggetaboutit host_override=None
DEBUG 04/29/2020 06:31:42 AM PlannerConnection(service=<okera.odas._ThriftService object at 0x10b0acfd0>)
INFO 04/29/2020 06:31:42 AM 	Fetching table 'collibra_import2.hades2'
DEBUG 04/29/2020 06:31:42 AM Closing Planner connection
DEBUG 04/29/2020 06:31:42 AM close_service: client=<thriftpy.thrift.TClient object at 0x10b0aced0>
INFO 04/29/2020 06:31:42 AM ############ END: PyOkera calls ############
INFO 04/29/2020 06:31:42 AM ### START: Create table hash ###
INFO 04/29/2020 06:31:42 AM 	Successfully created hash for table 'collibra_import2.hades2': 5d859aa05a01f4c1110276856d690fc5
INFO 04/29/2020 06:31:42 AM ### END: Create table hash ###
INFO 04/29/2020 06:31:42 AM 	No changes found: Table 'collibra_import2.hades2' is up to date!
INFO 04/29/2020 06:31:42 AM ############ START: PyOkera calls ############
DEBUG 04/29/2020 06:31:42 AM Connecting to planner sandbox.demo.okera.com:12050 with DIGEST-MD5 authentication mechanism
DEBUG 04/29/2020 06:31:42 AM get_socket: host=sandbox.demo.okera.com port=12050 use_ssl=False ca_cert=None
DEBUG 04/29/2020 06:31:42 AM get_transport: socket=<thriftpy.transport.socket.TSocket object at 0x10b0b6850> host=sandbox.demo.okera.com service_name=cerebro auth_mechanism=DIGEST-MD5 user=None password=fuggetaboutit host_override=None
DEBUG 04/29/2020 06:31:43 AM PlannerConnection(service=<okera.odas._ThriftService object at 0x10b0b6350>)
INFO 04/29/2020 06:31:44 AM 	Fetching table 'collibra_import.cool'
INFO 04/29/2020 06:31:44 AM 	### START: Format tags ###
INFO 04/29/2020 06:31:44 AM 		Formatting tags for Okera as 'namespace.key'
DEBUG 04/29/2020 06:31:44 AM 		Formatted tags: ['information_classification.nonpublic']
INFO 04/29/2020 06:31:44 AM 	### END: Format tags ###
DEBUG 04/29/2020 06:31:44 AM Closing Planner connection
DEBUG 04/29/2020 06:31:44 AM close_service: client=<thriftpy.thrift.TClient object at 0x10b0b6050>
INFO 04/29/2020 06:31:44 AM ############ END: PyOkera calls ############
INFO 04/29/2020 06:31:44 AM ### START: Create table hash ###
INFO 04/29/2020 06:31:44 AM 	Successfully created hash for table 'collibra_import.cool': 3518d3d424cdbcb773bd093e96649274
INFO 04/29/2020 06:31:44 AM ### END: Create table hash ###
INFO 04/29/2020 06:31:44 AM 	No changes found: Table 'collibra_import.cool' is up to date!
INFO 04/29/2020 06:31:44 AM ############ SUMMARY: ASSETS FETCHED AND COMPARED ############
DEBUG 04/29/2020 06:31:44 AM ### OKERA TABLE 'collibra_import.nifty' ###
{'asset_id': 'e59d95c6-bc64-4fb7-a8ab-0dea121ea697',
 'asset_type': 'Table',
 'asset_type_id': None,
 'attribute_ids': None,
 'attributes': {'Description': 'Kinda nifty',
                'Location': 'file:/test-warehouse/collibra_import.db/nifty'},
 'children': ['collibra_import.nifty.nifty_col'],
 'displayName': 'nifty',
 'last_collibra_sync_time': '1588192228',
 'name': 'collibra_import.nifty',
 'relation': {'Name': 'collibra_import', 'Type': 'Database'},
 'table_hash': '4a36c7029526921b005f9e1cec3ff721',
 'tags': None}
DEBUG 04/29/2020 06:31:44 AM ### COLLIBRA TABLE 'collibra_import.nifty' ###
{'asset_id': 'e59d95c6-bc64-4fb7-a8ab-0dea121ea697',
 'asset_type': 'Table',
 'asset_type_id': '00000000-0000-0000-0000-000000031007',
 'attribute_ids': None,
 'attributes': None,
 'children': None,
 'displayName': 'nifty',
 'last_collibra_sync_time': None,
 'name': 'collibra_import.nifty',
 'relation': None,
 'table_hash': None,
 'tags': None}
DEBUG 04/29/2020 06:31:44 AM ### OKERA COLUMN 'collibra_import.nifty.nifty_col' ###
{'asset_id': None,
 'asset_type': 'Column',
 'asset_type_id': None,
 'attribute_ids': None,
 'attributes': {'Description': None},
 'children': None,
 'displayName': 'nifty_col',
 'last_collibra_sync_time': None,
 'name': 'collibra_import.nifty.nifty_col',
 'relation': {'Name': 'collibra_import.nifty',
              'Type': 'Table',
              'id': 'e59d95c6-bc64-4fb7-a8ab-0dea121ea697'},
 'table_hash': None,
 'tags': None}
DEBUG 04/29/2020 06:31:44 AM ### COLLIBRA COLUMN 'collibra_import.nifty.nifty_col' ###
{'asset_id': '9958b47b-2e3c-4b89-bd48-340f6bc027c3',
 'asset_type': 'Column',
 'asset_type_id': '00000000-0000-0000-0000-000000031008',
 'attribute_ids': None,
 'attributes': None,
 'children': None,
 'displayName': 'nifty_col',
 'last_collibra_sync_time': None,
 'name': 'collibra_import.nifty.nifty_col',
 'relation': None,
 'table_hash': None,
 'tags': None}
DEBUG 04/29/2020 06:31:44 AM ### OKERA TABLE 'collibra_import2.hades2' ###
{'asset_id': '00b3b1f0-f416-43a4-9966-e31f97c754d1',
 'asset_type': 'Table',
 'asset_type_id': None,
 'attribute_ids': None,
 'attributes': {'Description': '10 columns!!',
                'Location': 'file:/test-warehouse/collibra_import2.db/hades2'},
 'children': ['collibra_import2.hades2.charon',
              'collibra_import2.hades2.cerberus',
              'collibra_import2.hades2.cronus',
              'collibra_import2.hades2.nyx',
              'collibra_import2.hades2.erinyes',
              'collibra_import2.hades2.thanatos',
              'collibra_import2.hades2.styx',
              'collibra_import2.hades2.hermes',
              'collibra_import2.hades2.erebos',
              'collibra_import2.hades2.hypnos'],
 'displayName': 'hades2',
 'last_collibra_sync_time': '1587073727',
 'name': 'collibra_import2.hades2',
 'relation': {'Name': 'collibra_import2', 'Type': 'Database'},
 'table_hash': '5d859aa05a01f4c1110276856d690fc5',
 'tags': None}
DEBUG 04/29/2020 06:31:44 AM ### OKERA TABLE 'collibra_import.cool' ###
{'asset_id': None,
 'asset_type': 'Table',
 'asset_type_id': None,
 'attribute_ids': None,
 'attributes': {'Description': 'Other other new import table.',
                'Location': 'file:/test-warehouse/collibra_import.db/cool'},
 'children': ['collibra_import.cool.cool_col'],
 'displayName': 'cool',
 'last_collibra_sync_time': '1587061678',
 'name': 'collibra_import.cool',
 'relation': {'Name': 'collibra_import', 'Type': 'Database'},
 'table_hash': '3518d3d424cdbcb773bd093e96649274',
 'tags': None}
INFO 04/29/2020 06:31:44 AM Import complete!
